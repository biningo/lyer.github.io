<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>HTTP协议 - lyer's blog</title><meta name=Description content><meta property="og:title" content="HTTP协议"><meta property="og:description" content="请求和响应报文   请求报文第一行必须指定 请求的方法、资源路径、HTTP协议版本
  紧接着就是请求头信息
  然后还需要一个空行
  紧接着如果有请求体的话就是请求体，注意如果没有请求体也必须加一个空行
  GET /note/ef1b6cee.html HTTP/1.1 Host: www.ru23.com Connection: keep-alive Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X)  ....各个请求头 <空行>   响应报文第一行必须指定 HTTP协议版本、状态码、状态码的字符串简短描述
  紧接着就是响应头信息，响应头中必须指定Content-Length，否则客户端不知道报文的结束位置(特殊情况另作考虑)
  然后还需要一个空行，空行的目的是为了更容易解析Header和Body，因为每个报文的Header大小是不确定的
  如果有响应体的化就需要一个响应体，没有的话空行也是必须的
  HTTP/1.1 200 OK Server: nginx/1.16.1 Date: Sun, 04 Oct 2020 02:27:01 GMT Last-Modified: Sun, 30 Aug 2020 14:12:42 GMT Content-Type: text/html Content-Length: 40846 Accept-Ranges: bytes <!"><meta property="og:type" content="article"><meta property="og:url" content="/2021/03/08/http%E5%8D%8F%E8%AE%AE/"><meta property="article:published_time" content="2021-03-08T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="HTTP协议"><meta name=twitter:description content="请求和响应报文   请求报文第一行必须指定 请求的方法、资源路径、HTTP协议版本
  紧接着就是请求头信息
  然后还需要一个空行
  紧接着如果有请求体的话就是请求体，注意如果没有请求体也必须加一个空行
  GET /note/ef1b6cee.html HTTP/1.1 Host: www.ru23.com Connection: keep-alive Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X)  ....各个请求头 <空行>   响应报文第一行必须指定 HTTP协议版本、状态码、状态码的字符串简短描述
  紧接着就是响应头信息，响应头中必须指定Content-Length，否则客户端不知道报文的结束位置(特殊情况另作考虑)
  然后还需要一个空行，空行的目的是为了更容易解析Header和Body，因为每个报文的Header大小是不确定的
  如果有响应体的化就需要一个响应体，没有的话空行也是必须的
  HTTP/1.1 200 OK Server: nginx/1.16.1 Date: Sun, 04 Oct 2020 02:27:01 GMT Last-Modified: Sun, 30 Aug 2020 14:12:42 GMT Content-Type: text/html Content-Length: 40846 Accept-Ranges: bytes <!"><meta name=application-name content="lyer's blog"><meta name=apple-mobile-web-app-title content="lyer's blog"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=/2021/03/08/http%E5%8D%8F%E8%AE%AE/><link rel=prev href=/2021/03/05/%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E5%92%8C%E5%8D%8F%E8%AE%AE%E6%A0%88%E6%80%BB%E8%A7%88/><link rel=next href=/2021/03/08/go%E8%AF%AD%E6%B3%95%E7%BB%86%E8%8A%82%E5%9F%BA%E7%A1%80/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"HTTP协议","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"\/2021\/03\/08\/http%E5%8D%8F%E8%AE%AE\/"},"genre":"posts","keywords":"HTTP","wordcount":364,"url":"\/2021\/03\/08\/http%E5%8D%8F%E8%AE%AE\/","datePublished":"2021-03-08T00:00:00+00:00","dateModified":"2021-03-08T00:00:00+00:00","publisher":{"@type":"Organization","name":"lyer"},"author":{"@type":"Person","name":"lyer"},"description":""}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':(''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="lyer's blog">lyer's blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>archive </a><a class=menu-item href=/tags/>tag </a><a class=menu-item href=/categories/>category </a><a class=menu-item href=/book>book </a><a class=menu-item href=/about>about </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="lyer's blog">lyer's blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/>archive</a><a class=menu-item href=/tags/>tag</a><a class=menu-item href=/categories/>category</a><a class=menu-item href=/book>book</a><a class=menu-item href=/about>about</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">HTTP协议</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://icepan.cloud title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>lyer</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E7%BD%91%E7%BB%9C/><i class="far fa-folder fa-fw"></i>网络</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-03-08>2021-03-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 364 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 2 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#请求和响应报文>请求和响应报文</a></li><li><a href=#url编码>URL编码</a></li><li><a href=#http请求方法>HTTP请求方法</a></li><li><a href=#http内容协商>HTTP内容协商</a></li><li><a href=#http头部字段和常见头部>HTTP头部字段和常见头部</a></li><li><a href=#body压缩>Body压缩</a></li><li><a href=#http文件下载>HTTP文件下载</a></li><li><a href=#form表单数据>FORM表单数据</a><ul><li><a href=#1x-www-form-urlencoded>1、x-www-form-urlencoded</a></li><li><a href=#2multipartform-data>2、multipart/form-data</a></li></ul></li><li><a href=#http长连接keep-alive>HTTP长连接keep-alive</a></li><li><a href=#http队首阻塞>HTTP队首阻塞</a></li><li><a href=#http代理>HTTP代理</a></li><li><a href=#http安全之basic认证>HTTP安全之Basic认证</a></li><li><a href=#参考>参考</a></li></ul></nav></div></div><div class=content id=content><h2 id=请求和响应报文>请求和响应报文</h2><ul><li><p>请求报文第一行必须指定 <strong>请求的方法、资源路径、HTTP协议版本</strong></p></li><li><p>紧接着就是请求头信息</p></li><li><p>然后还需要一个空行</p></li><li><p>紧接着如果有请求体的话就是请求体，注意如果没有请求体也必须加一个空行</p></li></ul><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=nf>GET</span> <span class=nn>/note/ef1b6cee.html</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
<span class=n>Host</span><span class=o>:</span> <span class=l>www.ru23.com</span>
<span class=n>Connection</span><span class=o>:</span> <span class=l>keep-alive</span>
<span class=n>Cache-Control</span><span class=o>:</span> <span class=l>max-age=0</span>
<span class=n>Upgrade-Insecure-Requests</span><span class=o>:</span> <span class=l>1</span>
<span class=n>User-Agent</span><span class=o>:</span> <span class=l>Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) </span>
<span class=err>....各个请求头</span>
<span class=g>&lt;空行&gt;
</span></code></pre></div><ul><li><p>响应报文第一行必须指定 <strong>HTTP协议版本、状态码、状态码的字符串简短描述</strong></p></li><li><p>紧接着就是响应头信息，响应头中必须指定<code>Content-Length</code>，否则客户端不知道报文的结束位置(特殊情况另作考虑)</p></li><li><p>然后还需要一个空行，空行的目的是为了更容易解析Header和Body，因为每个报文的Header大小是不确定的</p></li><li><p>如果有响应体的化就需要一个响应体，没有的话空行也是必须的</p></li></ul><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>200</span> <span class=ne>OK</span>
<span class=n>Server</span><span class=o>:</span> <span class=l>nginx/1.16.1</span>
<span class=n>Date</span><span class=o>:</span> <span class=l>Sun, 04 Oct 2020 02:27:01 GMT</span>
<span class=n>Last-Modified</span><span class=o>:</span> <span class=l>Sun, 30 Aug 2020 14:12:42 GMT</span>
<span class=n>Content-Type</span><span class=o>:</span> <span class=l>text/html</span>
<span class=n>Content-Length</span><span class=o>:</span> <span class=l>40846</span>
<span class=n>Accept-Ranges</span><span class=o>:</span> <span class=l>bytes</span>

<span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;generator&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;Hexo 3.8.0&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
    	<span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
    	.....
    	<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div><p>​</p><h2 id=url编码>URL编码</h2><p>如果在浏览器中输入的URL含有特殊字符或则非<code>ASCII</code>比如中午，浏览器则会进行转义编码操作，编码方法就是将非ASCII或则特殊字符转化为 <strong>16进制</strong>，然后在前面加一个<code>%</code></p><p>比如中文的话则会根据对应的UTF8编码的二进制转化为16进制然后加一个<code>%</code>，比如:</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>%E9%93%B6%E6%B2%B3
</code></pre></div><p>如果我们收到一个URL编码的query参数是这样的格式，那么可以用上述方法进行解码</p><p>​</p><h2 id=http请求方法>HTTP请求方法</h2><p><strong>请求方法单词必须全部大写</strong></p><table><thead><tr><th>方法名字</th><th>含义</th></tr></thead><tbody><tr><td><code>GET</code></td><td>获取资源，可以理解为读取或者下载数据</td></tr><tr><td><code>HEAD</code></td><td>只获取HTTP头部信息，不返回Body</td></tr><tr><td><code>POST</code></td><td>上传数据到server，数据保存在Body</td></tr><tr><td><code>DELETE</code></td><td>删除资源</td></tr><tr><td><code>OPTIONS</code></td><td>列出服务器支持那些类型的HTTP请求，比如GET、POST，由响应报文头部的<code>Allow</code>字段列出</td></tr><tr><td><code>CONNECT</code></td><td>建立特殊的连接隧道</td></tr><tr><td><code>PUT</code></td><td>更新资源，整个替换</td></tr><tr><td><code>PATCH</code></td><td>更新资源，部分替换</td></tr></tbody></table><p>​</p><h2 id=http内容协商>HTTP内容协商</h2><p>内容协商是指客户端希望得到什么类型的数据或则希望采用什么编码，服务器需要根据客户端的请求来做出合理的响应</p><p>客户端和内容协商的请求头都以 <code>Accept-</code>开头，服务器响应内容协商的相关头部都以<code>Content-</code>开头</p><p><code>Accept</code> 允许的响应MINE类型</p><p><code>Content-Type</code>服务器响应的MINE类型，一般服务器的编码会在Cotent-Type头部指定，浏览器会根据<code>chartset</code>指定的编码来进行解码，默认都是UTF-8编码，所以如果Content-Type指定的charset和传递数据的编码方式不一致的话就会产生乱码</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1>#q表示质量因子 也就是权重</span>
Accept: text/html,application/xhtml+xml,application/xml<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.9,*/*<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.8
</code></pre></div><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1>#浏览器会采用charset中的编码方式进行解码</span>
Content-Type: text/html<span class=p>;</span> <span class=nv>charset</span><span class=o>=</span>utf-8 
</code></pre></div><p><code>Accept-Encoding</code> 允许的内容编码 ，主要用于压缩 <code>Content-Encoding</code> 服务器采用的压缩编码</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Accept-Encoding: gzip, deflate, br
</code></pre></div><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Content-Encoding: gzip
</code></pre></div><p><code>Accept-Language</code> 允许的语言 <code>Content-Language</code>服务器响应的语言</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Accept-Language: zh-CN,zh<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.9,en-US<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.8,en<span class=p>;</span><span class=nv>q</span><span class=o>=</span>0.7
</code></pre></div><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Content-Language: zh-CN
</code></pre></div><p>另外服务器必须指定<code>Content-Length</code>来表示响应Body的长度，如果是 <strong>Chunk</strong>传输不知道长度则必须指定<code>Transfer-Encoding:chunked</code></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Content-Length: <span class=m>1000</span> <span class=c1>#byte</span>
</code></pre></div><p><code>Vary</code> 列出了服务器参考了哪些Header字段来进行内容协商</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Vary: Accept-Encoding,Accept
</code></pre></div><p>常见的的 <strong>MINE</strong> 类型如下:</p><table><thead><tr><th>MINE</th><th>描述</th></tr></thead><tbody><tr><td><code>text/html</code> <code>text/css</code> <code>text/plain</code>纯文本</td><td>文本类型</td></tr><tr><td><code>image/gif</code> <code>image/png</code> &mldr;</td><td>图片类型</td></tr><tr><td><code>audio/mp4</code> <code>audio/mp3</code> &mldr;</td><td>音视频类型</td></tr><tr><td><code>application/json</code> <code>application/pdf</code> <code>application/javascript</code> <code>application/octet-stream</code>未知的二进制流类型</td><td>应用类型</td></tr></tbody></table><p>​</p><h2 id=http头部字段和常见头部>HTTP头部字段和常见头部</h2><table><thead><tr><th>类型</th><th>含义</th></tr></thead><tbody><tr><td>通用字段</td><td>在请求头和响应头里都可以出现</td></tr><tr><td>请求字段</td><td>仅能出现在请求头里，进一步说明请求信息或者额外的附加条件</td></tr><tr><td>响应字段</td><td>仅能出现在响应头里，补充说明响应报文的信息</td></tr><tr><td>实体字段</td><td>属于通用字段，但专门描述 body 的额外信息</td></tr></tbody></table><p>头部字段是不区分大小写的，比如<code>Host</code>和<code>host</code>是一样的，但是一般建议使用大写，并且我们不仅仅可以使用HTTP规范的头部，还自定义头部字段，自定义头部需要注意以下几个规则:</p><ul><li>头部字段名字不允许出现空格，可以允许 <code>-</code> 来分割不同的单词，但是不允许使用 <code>_</code> 下划线，比如<code>User-Name</code>是合法的，<code>User_Name</code>就是非法的</li><li>字段名后面必须紧接着<code>:</code>，不能有空格</li><li>头部字段顺序没有意义，可以随意排列</li><li>有些头部字段可以重复设置例如 <code>Set-Cookie</code>，有些则只能设置一个比如<code>Host</code></li></ul><p><strong>下面来看一些常见头部</strong>:</p><p><code>User-Agent</code> 客户端类型，浏览器类型，浏览器内核版本信息，操作系统类型等</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>User-Agent: Mozilla/5.0 <span class=o>(</span>X11<span class=p>;</span> Linux x86_64<span class=o>)</span> AppleWebKit/537.36 <span class=o>(</span>KHTML, like Gecko<span class=o>)</span> Chrome/84.0.4147.89 Safari/537.36
</code></pre></div><p><code>Host</code> 表示请求的域名，DNS获取到IP只是请求到那台机器，因为一个机器可能会开好几个服务和域名，所以需要Host来标识是哪个服务</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Host: v.qq.com
</code></pre></div><blockquote><p>nginx中配置的<code>server_name</code>需要和HTTP头部的<code>Host</code>字段相匹配这样才可以访问，如果不匹配则会走默认的server_name，这样可以实现一台主机多个域名</p></blockquote><p><code>Date</code> 表示报文创建的时间，<strong>GMT</strong> 格式</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Date: Sun, <span class=m>04</span> Oct <span class=m>2020</span> 02:27:01 GMT
</code></pre></div><p><code>Referer</code> 求来自哪个页面，由浏览器来自动添加</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Referer:https://www.google.com
</code></pre></div><p><code>Server</code> 服务器类型</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Server: nginx
</code></pre></div><p><code>Allow</code> 服务器运行的请求类型</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Allow: GET,POST,OPTIONS      
</code></pre></div><p>​</p><h2 id=body压缩>Body压缩</h2><p>报文压缩、加密等都是对于HTTP报文的<code>Body</code>部分进行的，<strong>压缩和加密</strong> 其实都是对Body的一种编码方式，比如启用 <code>gzip</code>压缩就是对Body部分进行<code>gzip</code>格式的编解码，这样就达到了压缩的效果，进行压缩或则加密的报文都需要消耗一定的CPU资源</p><p>压缩<code>Body</code>的时候服务器需要在响应的Header指定<code>Content-Encoding</code>:</p><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>200</span> <span class=ne>ok</span>
<span class=n>Content-Encoding</span><span class=o>:</span> <span class=l>gzip</span>
<span class=err>....</span>
</code></pre></div><p>这样客户端就可以根据这个字段来知道Body是否被编码，以此来解码</p><p>客户端在请求的时候也可以设置Header指定<code>Accept-Encoding</code>字段表明自己可以接受哪些编码方式，服务器就可以根据客户端的请求来改变相应的响应策略</p><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=nf>GET</span> <span class=nn>/a/b.html</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
<span class=n>Accept-Encoding</span><span class=o>:</span> <span class=l>gzip,deflate,compress</span>
<span class=err>...</span>
</code></pre></div><p>​</p><h2 id=http文件下载>HTTP文件下载</h2><p>HTTP下载文件时必须要设置的两个头部:</p><p><code>Content-Type</code> 用于指定待下载文件的类型</p><p><code>Content-Disposition</code> 用于指定下载后文件名以及相应的编码规则</p><ul><li><code>attachment</code>表示浏览器会将数据下载下来，如果不设置则不会进行下载</li><li><code>inline</code> 表示响应中的消息体会以页面的一部分或者整个页面的形式展示</li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Content-Type: application/pdf
Content-Disposition: attachment<span class=p>;</span> <span class=nv>filename</span><span class=o>=</span><span class=s2>&#34;filename.jpg&#34;</span> 
</code></pre></div><p>​</p><h2 id=form表单数据>FORM表单数据</h2><p><code>Content-Type</code>在Post提交的时候也会用到，告诉服务器提交的信息属于Form表单编码还是JSON格式，并且POST请求也需要指定<code>Content-Length</code></p><p>HTML表单里可以根据<code>&lt;form enctype="application/form-data"></code> 来指定表单上传的编码方式，POST提交的数据主要有如下几个类型</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Conent-Type: mutipart-data
Content-type: x-www.form-urlencoded <span class=c1>#form不指定enctype默认就是这种编码</span>
Conent-Type: application/json
</code></pre></div><h3 id=1x-www-form-urlencoded>1、x-www-form-urlencoded</h3><p>提交的表单数据按照 <code>key=val&key=val</code>方式进行编码</p><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=nf>POST</span> <span class=nn>http://www.example.com</span> <span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span>
<span class=n>Content-Type</span><span class=o>:</span> <span class=l>application/x-www-form-urlencoded;charset=utf-8</span>

name=lyer&amp;age=18
</code></pre></div><h3 id=2multipartform-data>2、multipart/form-data</h3><p>需要在<code>Content-Type</code>中指定<code>boundary</code>分隔符</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>POST http://www.example.com HTTP/1.1
Content-Type:multipart/form-data<span class=p>;</span> <span class=nv>boundary</span><span class=o>=</span>-------XXXX

-------XXXX
Content-Disposition: form-data<span class=p>;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;username&#34;</span>

lyer
-------XXXX
Content-Disposition: form-data<span class=p>;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;age&#34;</span>

<span class=m>18</span>
-------XXXX
Content-Disposition: form-data<span class=p>;</span> <span class=nv>name</span><span class=o>=</span><span class=s2>&#34;file&#34;</span><span class=p>;</span> <span class=nv>filename</span><span class=o>=</span><span class=s2>&#34;a.png&#34;</span>
Content-Type: image/png

&lt;二进制数据&gt;
-------XXXX
</code></pre></div><p>​</p><h2 id=http长连接keep-alive>HTTP长连接keep-alive</h2><p><code>Connection</code> 默认值是<code>keep-alive</code></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Connection:close <span class=c1>#立即关闭此次TCP连接 即不支持长链接</span>
</code></pre></div><p>​</p><h2 id=http队首阻塞>HTTP队首阻塞</h2><p>HTTP是 <strong>请求-应答</strong> 模式，如果同时发送多个请求那么当浏览器收到多个应答的时候就无法辨别那个应答属于哪个请求，所以HTTP协议必须是一收一发的，一个请求发送之后必须等待其应答回来之后才可以发送下一个请求，每个请求必须排队发送</p><p><strong>所以每个请求需要加入一个请求队列，只有等前面请求的应答收到之后此请求才可以发送</strong></p><p>如果队首有请求阻塞了，那么后面所有的请求都必须等待，这就是 <strong>队首阻塞问题</strong></p><p>为了解决队首阻塞问题造成的速度慢，有如下几个方法:</p><ul><li>浏览器多开几个线程并发进行请求后端服务器资源，此方法问题就是后端服务器接收到的并发数量巨大: <strong>用户数并发请求线程数</strong> 造成服务器压力太大，所以一般浏览器只会开<code>6~8</code>个线程左右的进行并发请求</li><li><strong>域名分片</strong> 也就是给一台机器一个服务多开几个域名，这样分别将用户的请求负载均衡到各个域名上去请求同一台机器，这样并发也上去了</li></ul><p>​</p><h2 id=http代理>HTTP代理</h2><p><code>Via</code> 保存经过的代理节点的主机名字或则域名</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png data-srcset="https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png, https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png 1.5x, https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png title=https://raw.githubusercontent.com/biningo/cdn/master/img1/image-20201007095736179.png></p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>Via: nginx-1,nginx-2
</code></pre></div><p><code>X-Forwarded-For</code> 保存经过代理的IP</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>X-Forwarded-For: 192.168.0.10,192.168.0.12
</code></pre></div><p>​</p><h2 id=http安全之basic认证>HTTP安全之Basic认证</h2><p>Basic认证安全性比较低，但是其实现比较简单，只需要加一个头部即可</p><p>比如现在访问 <code>/api</code>资源，服务器发现没有通过认证，于是范围如下报文</p><div class=highlight><pre class=chroma><code class=language-http data-lang=http><span class=kr>HTTP</span><span class=o>/</span><span class=m>1.1</span> <span class=m>401</span> <span class=ne>Unauthorized</span>
<span class=n>WWW-Authenticate</span><span class=o>:</span> <span class=l>Basic realm=&lt;认证范围,随便写&gt;</span>
</code></pre></div><p>现在浏览器都实现了Basic认证弹窗，当收到这样的报文之后浏览器就会弹窗要求用户输入密码，如果严重通过则可以访问，如果不通过则继续返回<code>401</code>或则返回<code>403</code></p><p>用户输入密码之后，浏览器会在头部加上<code>Authorization: base64编码(username:pwd)</code></p><p>​</p><h2 id=参考>参考</h2><ul><li><a href=https://www.cnblogs.com/lightsong/p/4172979.html>https://www.cnblogs.com/lightsong/p/4172979.html</a> 【第三方Cookie】</li><li><a href=https://www.zoo.team/article/http-cache>https://www.zoo.team/article/http-cache</a> 【缓存】</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2021-03-08</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/http/>HTTP</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/2021/03/05/%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E5%92%8C%E5%8D%8F%E8%AE%AE%E6%A0%88%E6%80%BB%E8%A7%88/ class=prev rel=prev title=网络分层和协议栈总览><i class="fas fa-angle-left fa-fw"></i>网络分层和协议栈总览</a>
<a href=/2021/03/08/go%E8%AF%AD%E6%B3%95%E7%BB%86%E8%8A%82%E5%9F%BA%E7%A1%80/ class=next rel=next title=Go语法细节基础>Go语法细节基础<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments><div id=gitalk class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://github.com/gitalk/gitalk></a>Gitalk</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.80.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://icepan.cloud target=_blank>lyer</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/gitalk/gitalk.min.css><script type=text/javascript src=/lib/gitalk/gitalk.min.js></script><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/algoliasearch/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"gitalk":{"admin":["biningo"],"clientID":"c8f473d59880800a7453","clientSecret":"7aa3dd0bcf966dee0a057e06eaf205caeb86b8e0","id":"2021-03-08T00:00:00Z","owner":"biningo","repo":"hugo-blog-gittalk","title":"HTTP协议"}},"search":{"algoliaAppID":null,"algoliaIndex":null,"algoliaSearchKey":null,"highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>